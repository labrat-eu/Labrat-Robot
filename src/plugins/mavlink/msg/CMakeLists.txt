cmake_minimum_required(VERSION 3.22.0)


# Set the target name from the path.
get_filename_component(TARGET_DIR ${CMAKE_CURRENT_SOURCE_DIR} DIRECTORY)
get_filename_component(TARGET_NAME_PRIMARY ${TARGET_DIR} NAME)
get_filename_component(TARGET_NAME_SECONDARY ${CMAKE_CURRENT_SOURCE_DIR} NAME)
set(TARGET_NAME ${TARGET_NAME_PRIMARY}_${TARGET_NAME_SECONDARY})

# Get the install path.
file(RELATIVE_PATH TARGET_RELATIVE_PATH ${PROJECT_SOURCE_DIR}/src ${CMAKE_CURRENT_SOURCE_DIR})

set(TARGET_MESSAGES
  common.fbs
  actuator_control_target.fbs
  actuator_output_status.fbs
  adsb_vehicle.fbs
  ais_vessel.fbs
  altitude.fbs
  attitude.fbs
  attitude_quaternion_cov.fbs
  attitude_quaternion.fbs
  attitude_target.fbs
  att_pos_mocap.fbs
  auth_key.fbs
  autopilot_state_for_gimbal_device.fbs
  autopilot_version.fbs
  battery_info.fbs
  battery_status.fbs
  button_change.fbs
  camera_capture_status.fbs
  camera_fov_status.fbs
  camera_image_captured.fbs
  camera_information.fbs
  camera_settings.fbs
  camera_tracking_geo_status.fbs
  camera_tracking_image_status.fbs
  camera_trigger.fbs
  canfd_frame.fbs
  can_filter_modify.fbs
  can_frame.fbs
  cellular_config.fbs
  cellular_status.fbs
  change_operator_control_ack.fbs
  change_operator_control.fbs
  collision.fbs
  command_ack.fbs
  command_cancel.fbs
  command_int.fbs
  command_long.fbs
  component_information.fbs
  component_metadata.fbs
  control_system_state.fbs
  current_event_sequence.fbs
  data_stream.fbs
  data_transmission_handshake.fbs
  debug.fbs
  debug_float_array.fbs
  debug_vect.fbs
  distance_sensor.fbs
  efi_status.fbs
  encapsulated_data.fbs
  esc_info.fbs
  esc_status.fbs
  estimator_status.fbs
  event.fbs
  extended_sys_state.fbs
  fence_status.fbs
  file_transfer_protocol.fbs
  flight_information.fbs
  follow_target.fbs
  generator_status.fbs
  gimbal_device_attitude_status.fbs
  gimbal_device_information.fbs
  gimbal_device_set_attitude.fbs
  gimbal_manager_information.fbs
  gimbal_manager_set_attitude.fbs
  gimbal_manager_set_manual_control.fbs
  gimbal_manager_set_pitchyaw.fbs
  gimbal_manager_status.fbs
  global_position_int_cov.fbs
  global_position_int.fbs
  global_vision_position_estimate.fbs
  gps2_raw.fbs
  gps2_rtk.fbs
  gps_global_origin.fbs
  gps_inject_data.fbs
  gps_input.fbs
  gps_raw_int.fbs
  gps_rtcm_data.fbs
  gps_rtk.fbs
  gps_status.fbs
  heartbeat.fbs
  high_latency2.fbs
  high_latency.fbs
  highres_imu.fbs
  hil_actuator_controls.fbs
  hil_controls.fbs
  hil_gps.fbs
  hil_optical_flow.fbs
  hil_rc_inputs_raw.fbs
  hil_sensor.fbs
  hil_state.fbs
  hil_state_quaternion.fbs
  home_position.fbs
  hygrometer_sensor.fbs
  isbd_link_status.fbs
  landing_target.fbs
  link_node_status.fbs
  local_position_ned_cov.fbs
  local_position_ned.fbs
  local_position_ned_system_global_offset.fbs
  log_data.fbs
  log_entry.fbs
  log_erase.fbs
  logging_ack.fbs
  logging_data_acked.fbs
  logging_data.fbs
  log_request_data.fbs
  log_request_end.fbs
  log_request_list.fbs
  mag_cal_report.fbs
  manual_control.fbs
  manual_setpoint.fbs
  memory_vect.fbs
  message_interval.fbs
  mission_ack.fbs
  mission_clear_all.fbs
  mission_count.fbs
  mission_current.fbs
  mission_item.fbs
  mission_item_int.fbs
  mission_item_reached.fbs
  mission_request.fbs
  mission_request_int.fbs
  mission_request_list.fbs
  mission_request_partial_list.fbs
  mission_set_current.fbs
  mission_write_partial_list.fbs
  mount_orientation.fbs
  named_value_float.fbs
  named_value_int.fbs
  nav_controller_output.fbs
  obstacle_distance.fbs
  odometry.fbs
  onboard_computer_status.fbs
  open_drone_id_arm_status.fbs
  open_drone_id_authentication.fbs
  open_drone_id_basic_id.fbs
  open_drone_id_location.fbs
  open_drone_id_message_pack.fbs
  open_drone_id_operator_id.fbs
  open_drone_id_self_id.fbs
  open_drone_id_system.fbs
  open_drone_id_system_update.fbs
  optical_flow.fbs
  optical_flow_rad.fbs
  orbit_execution_status.fbs
  param_ext_ack.fbs
  param_ext_request_list.fbs
  param_ext_request_read.fbs
  param_ext_set.fbs
  param_ext_value.fbs
  param_map_rc.fbs
  param_request_list.fbs
  param_request_read.fbs
  param_set.fbs
  param_value.fbs
  ping.fbs
  play_tune.fbs
  play_tune_v2.fbs
  position_target_global_int.fbs
  position_target_local_ned.fbs
  power_status.fbs
  protocol_version.fbs
  radio_status.fbs
  raw_imu.fbs
  raw_pressure.fbs
  raw_rpm.fbs
  rc_channels.fbs
  rc_channels_override.fbs
  rc_channels_raw.fbs
  rc_channels_scaled.fbs
  request_data_stream.fbs
  request_event.fbs
  resource_request.fbs
  response_event_error.fbs
  safety_allowed_area.fbs
  safety_set_allowed_area.fbs
  scaled_imu2.fbs
  scaled_imu3.fbs
  scaled_imu.fbs
  scaled_pressure2.fbs
  scaled_pressure3.fbs
  scaled_pressure.fbs
  serial_control.fbs
  servo_output_raw.fbs
  set_actuator_control_target.fbs
  set_attitude_target.fbs
  set_gps_global_origin.fbs
  set_home_position.fbs
  set_mode.fbs
  set_position_target_global_int.fbs
  set_position_target_local_ned.fbs
  setup_signing.fbs
  sim_state.fbs
  statustext.fbs
  storage_information.fbs
  supported_tunes.fbs
  sys_status.fbs
  system_time.fbs
  terrain_check.fbs
  terrain_data.fbs
  terrain_report.fbs
  terrain_request.fbs
  time_estimate_to_target.fbs
  timesync.fbs
  trajectory_representation_bezier.fbs
  trajectory_representation_waypoints.fbs
  tunnel.fbs
  uavcan_node_info.fbs
  uavcan_node_status.fbs
  utm_global_position.fbs
  v2_extension.fbs
  vfr_hud.fbs
  vibration.fbs
  vicon_position_estimate.fbs
  video_stream_information.fbs
  video_stream_status.fbs
  vision_position_estimate.fbs
  vision_speed_estimate.fbs
  wheel_distance.fbs
  wifi_config_ap.fbs
  winch_status.fbs
  wind_cov.fbs
)

set(TARGET_NAME_MESSAGE ${TARGET_NAME})
lbot_generate_flatbuffer(TARGET ${TARGET_NAME_MESSAGE} SCHEMAS ${TARGET_MESSAGES} TARGET_PATH ${LOCAL_PROJECT_PATH_FULL}/${TARGET_RELATIVE_PATH})
